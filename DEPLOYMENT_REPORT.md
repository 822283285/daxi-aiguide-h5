# å¤§å¸Œåœ°å›¾é¡¹ç›®éƒ¨ç½²æŠ¥å‘Š

**éƒ¨ç½²æ—¶é—´**: 2026-03-01 11:55 GMT+8  
**éƒ¨ç½²ç‰ˆæœ¬**: v1.0.0  
**éƒ¨ç½²ç¯å¢ƒ**: Production  
**è®¿é—®åœ°å€**: https://html.qkbyte.cn/daxi/

---

## âœ… å®Œæˆçš„ä»»åŠ¡

### 1. é…ç½®ç®¡ç†

#### âœ… runtime-config.js åˆ›å»ºå®Œæˆ

**æ–‡ä»¶ä½ç½®**: `/home/ubuntu/.openclaw/workspace/code/daxi-aiguide-h5/runtime-config.js`

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼ˆdev/uat/prodï¼‰
- âœ… é…ç½® API åœ°å€ã€åœ°å›¾æ•°æ®åœ°å€ã€WebSocket åœ°å€
- âœ… æ”¯æŒ URL å‚æ•°è¦†ç›–é…ç½®
- âœ… è‡ªåŠ¨ç¯å¢ƒæ£€æµ‹å’Œæ—¥å¿—è¾“å‡º
- âœ… å…¨å±€å¯è®¿é—®ï¼š`window.runtimeConfig`

**ç¯å¢ƒé…ç½®**:

| ç¯å¢ƒ | API åœ°å€ | åœ°å›¾æ•°æ®åœ°å€ | WebSocket åœ°å€ | æ—¥å¿— |
|------|---------|-------------|---------------|------|
| dev | https://cloud.daxicn.com/publicData | https://cloud.daxicn.com/publicData | wss://map.daxicn.com/ws/loc | âœ“ |
| uat | https://cloud.daxicn.com/publicData | https://cloud.daxicn.com/publicData | wss://map.daxicn.com/ws/loc | âœ“ |
| prod | https://cloud.daxicn.com/scenic | https://cloud.daxicn.com/scenic | wss://map.daxicn.com/ws/loc | âœ— |

**ä½¿ç”¨æ–¹æ³•**:
```javascript
// è·å–å®Œæ•´é…ç½®
const config = window.runtimeConfig.getConfig();

// è·å–å•ä¸ªå‚æ•°
const token = window.runtimeConfig.getParam('token');

// è·å–å½“å‰ç¯å¢ƒ
const env = window.runtimeConfig.getCurrentEnv();

// è·å–åœ°å›¾æ•°æ® URL
const mapUrl = window.runtimeConfig.getMapDataUrl();
```

---

### 2. index.html æ›´æ–°

#### âœ… æ›´æ–°å®Œæˆ

**ä¿®æ”¹å†…å®¹**:
- âœ… æ·»åŠ  runtime-config è„šæœ¬ï¼ˆåœ¨ `<head>` ä¸­ä¼˜å…ˆåŠ è½½ï¼‰
- âœ… é…ç½®æ­£ç¡®çš„å…¥å£è„šæœ¬
- âœ… ä¿ç•™æ‰€æœ‰å¿…è¦çš„ meta æ ‡ç­¾
- âœ… ä¿æŒ SEO ä¼˜åŒ–é…ç½®

**å…³é”®æ”¹åŠ¨**:
```html
<!-- è¿è¡Œæ—¶é…ç½® (å¿…é¡»åœ¨å…¶ä»–è„šæœ¬ä¹‹å‰åŠ è½½) -->
<script src="./runtime-config.js"></script>
```

---

### 3. æ„å»ºé…ç½®ä¼˜åŒ–

#### âœ… vite.config.js ä¼˜åŒ–å®Œæˆ

**ä¼˜åŒ–å†…å®¹**:

1. **åŠ¨æ€åŸºç¡€è·¯å¾„**:
   - å¼€å‘ç¯å¢ƒï¼š`./`
   - ç”Ÿäº§ç¯å¢ƒï¼š`/daxi/`

2. **ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–**:
   - ç”Ÿäº§ç¯å¢ƒæ‰ç§»é™¤ console.log
   - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å“ˆå¸Œæ–‡ä»¶å
   - å¼€å‘ç¯å¢ƒä¿ç•™ sourcemap

3. **ä»£ç åˆ†å‰²**:
   - ç¬¬ä¸‰æ–¹ä¾èµ–åˆ†å‰²ï¼ˆvendor-core, vendor-polyfillsï¼‰
   - SDK åˆ†å‰²ï¼ˆmap-sdk, jsbridgeï¼‰
   - é¡µé¢æ‡’åŠ è½½åˆ†å‰²ï¼ˆpage-xxxï¼‰

4. **å›¾ç‰‡ä¼˜åŒ–**:
   - è‡ªåŠ¨å‹ç¼©å›¾ç‰‡èµ„æº
   - æ€»èŠ‚çœï¼š2392.81KB â‰ˆ 63%

---

### 4. æœ¬åœ°æµ‹è¯•

#### âœ… æ„å»ºæµ‹è¯•é€šè¿‡

**æ„å»ºå‘½ä»¤**: `pnpm exec vite build`

**æ„å»ºç»“æœ**:
```
âœ“ æ„å»ºå®Œæˆ
âœ“ å›¾ç‰‡ä¼˜åŒ–ï¼š63% å‹ç¼©ç‡
âœ“ ä»£ç åˆ†å‰²ï¼šæ­£å¸¸
âœ“ èµ„æºè¾“å‡ºï¼šdist/
```

**è¾“å‡ºæ–‡ä»¶**:
- `dist/index.html` - ä¸»é¡µé¢
- `dist/assets/` - é™æ€èµ„æº
  - JS æ–‡ä»¶ï¼ˆå¸¦å“ˆå¸Œï¼‰
  - CSS æ–‡ä»¶
  - å›¾ç‰‡èµ„æº

---

### 5. æ„å»ºéƒ¨ç½²

#### âœ… éƒ¨ç½²å®Œæˆ

**éƒ¨ç½²å‘½ä»¤**:
```bash
pnpm exec vite build
sudo rsync -av dist/ /var/www/html.qkbyte.cn/daxi/
sudo cp runtime-config.js /var/www/html.qkbyte.cn/daxi/
```

**éƒ¨ç½²ç›®å½•**: `/var/www/html.qkbyte.cn/daxi/`

**éƒ¨ç½²æ–‡ä»¶**:
- âœ… index.html (4.67 KB)
- âœ… runtime-config.js (5.55 KB)
- âœ… assets/ (åŒ…å«æ‰€æœ‰é™æ€èµ„æº)

---

### 6. çº¿ä¸ŠéªŒè¯

#### âœ… ç½‘ç«™å¯è®¿é—®

**è®¿é—®åœ°å€**: https://html.qkbyte.cn/daxi/

**éªŒè¯ç»“æœ**:
- âœ… ç½‘ç«™å¯è®¿é—®ï¼ˆHTTP 200ï¼‰
- âœ… é¡µé¢æ ‡é¢˜æ­£ç¡®ï¼šå¤§å¸Œæ™ºèƒ½å¯¼æ¸¸
- âœ… runtime-config.js å·²åŠ è½½
- âœ… èµ„æºè·¯å¾„æ­£ç¡®ï¼ˆ/daxi/assets/ï¼‰

---

## ğŸ“Š æ„å»ºç»Ÿè®¡

### å›¾ç‰‡ä¼˜åŒ–æ•ˆæœ

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| åŸå§‹å¤§å° | 3807.40 KB |
| ä¼˜åŒ–åå¤§å° | 1414.59 KB |
| èŠ‚çœç©ºé—´ | 2392.81 KB |
| å‹ç¼©ç‡ | 63% |

### ä¸»è¦ä¼˜åŒ–é¡¹

- âœ… autoDescTip.png: 352KB â†’ 121.6KB (-66%)
- âœ… pay_box.jpg: 103.68KB â†’ 64.02KB (-39%)
- âœ… icon_wechat.png: 7.44KB â†’ 1.68KB (-78%)
- âœ… posIn.png: 8.44KB â†’ 1.33KB (-85%)

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒåˆ‡æ¢

é€šè¿‡ URL å‚æ•°åˆ‡æ¢ç¯å¢ƒï¼š

```
# å¼€å‘ç¯å¢ƒ
https://html.qkbyte.cn/daxi/?env=dev

# æµ‹è¯•ç¯å¢ƒ
https://html.qkbyte.cn/daxi/?env=uat

# ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰
https://html.qkbyte.cn/daxi/?env=prod
```

### å¸¸ç”¨å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| env | ç¯å¢ƒ | dev/uat/prod |
| token | é¡¹ç›® token | ?token=xxx |
| buildingId | å»ºç­‘ ID | ?buildingId=xxx |
| userId | ç”¨æˆ· ID | ?userId=xxx |
| appId | åº”ç”¨ ID | ?appId=xxx |

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **åŠŸèƒ½éªŒè¯**:
   - [ ] æµ‹è¯•é¦–é¡µåŠ è½½
   - [ ] æµ‹è¯•åœ°å›¾æ˜¾ç¤º
   - [ ] æµ‹è¯•è·¯ç”±å¯¼èˆª
   - [ ] æµ‹è¯• API è°ƒç”¨

2. **æ€§èƒ½ç›‘æ§**:
   - [ ] æ·»åŠ æ€§èƒ½ç›‘æ§
   - [ ] ç›‘æ§é¦–å±åŠ è½½æ—¶é—´
   - [ ] ç›‘æ§èµ„æºåŠ è½½é”™è¯¯

3. **å®‰å…¨åŠ å›º**:
   - [ ] é…ç½® HTTPS
   - [ ] æ·»åŠ  CSP ç­–ç•¥
   - [ ] æ•æ„Ÿé…ç½®åŠ å¯†

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **runtime-config.js å¿…é¡»å•ç‹¬éƒ¨ç½²**
   - è¯¥æ–‡ä»¶ä¸ä¼šè¢« Vite æ‰“åŒ…
   - éœ€è¦æ‰‹åŠ¨å¤åˆ¶åˆ°éƒ¨ç½²ç›®å½•
   - å»ºè®®æ·»åŠ åˆ°éƒ¨ç½²è„šæœ¬ä¸­

2. **ç”Ÿäº§ç¯å¢ƒåŸºç¡€è·¯å¾„**
   - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ `/daxi/` ä½œä¸ºåŸºç¡€è·¯å¾„
   - ç¡®ä¿ Nginx/Apache é…ç½®æ­£ç¡®

3. **ç¼“å­˜ç­–ç•¥**
   - ç”Ÿäº§ç¯å¢ƒèµ„æºå¸¦å“ˆå¸Œï¼Œå¯é•¿æœŸç¼“å­˜
   - index.html å’Œ runtime-config.js ä¸åº”ç¼“å­˜

---

## âœ… äº¤ä»˜æ¸…å•

- [x] runtime-config.js é…ç½®å®Œæˆ
- [x] index.html æ›´æ–°å®Œæˆ
- [x] vite.config.js ä¼˜åŒ–å®Œæˆ
- [x] æœ¬åœ°æ„å»ºæµ‹è¯•é€šè¿‡
- [x] çº¿ä¸Šéƒ¨ç½²å®Œæˆ
- [x] ç½‘ç«™å¯è®¿é—®éªŒè¯

---

**éƒ¨ç½²çŠ¶æ€**: âœ… å®Œæˆ  
**éƒ¨ç½²äººå‘˜**: AI Assistant  
**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-03-01 11:55 GMT+8
